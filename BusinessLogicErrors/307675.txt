ReportLink:https://hackerone.com/reports/307675
WeaknessName:Business Logic Errors
Reporter:https://hackerone.com/edoverflow
ReportedTo:Keybase(keybase)
BountyAmount:1000.0
Severity:low
State:Closed
DateOfDisclosure:23.01.2018 19:58:23

Summary:

# Description

An attacker can claim ownership of a GitHub user's handle if the user forks the attacker's gist with a verification snippet generated by the attacker pointing towards the user's handle.

# PoC

With my colleague's permission (@jackds) I claimed their GitHub handle with this gist: https://gist.github.com/EdOverflow/ae2b07342dfd0c2793dcb763bca51770. They simply forked the gist, as seen here: https://gist.github.com/jackds1986/c722170d819e67b4fedb7447b84cd2b2. Keybase then imports the profile picture from @jackds' GitHub account and sets it as my Keybase profile picture.

{F256102}

To make matters worse, anybody that now browses to @jackds' GitHub profile using the Keybase browser extension believe they are messaging @jackds' when in fact all the messages land in my inbox. The UI makes it look like I am @jackds and therefore completely breaks the confidentiality of the Keybase service.

{F256105}

# Mitigation

When verifying ownership of GitHub handles, ensure that the gist is not a fork. I believe it is possible to do this with the GitHub gist API.

## Impact

Users can no longer trust GitHub handles on Keybase.