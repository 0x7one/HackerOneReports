ReportLink:https://hackerone.com/reports/88881
WeaknessName:Cross-site Scripting (XSS) - Generic
Reporter:https://hackerone.com/aesteral
ReportedTo:Mail.ru(mailru)
BountyAmount:500.0
Severity:
State:Closed
DateOfDisclosure:16.11.2015 13:22:40

Summary:

Здравствуйте!

https://light.mail.ru/compose и https://m.mail.ru/compose[id]/reply подвержены второму вектору XSS похожему на #88492. Вторая уязвимость существует из-за недостаточной фильтрации текста сообщения, на которое хочет ответить пользователь, при его выводе в <textarea> - поле ответа - в качестве цитаты.

Для того, чтобы выполнить произвольный JavaScript, следует выполнить следующее:

* Злоумышленник направляет жертве, пользующейся m.mail.ru или light.mail.ru письмо, содержащее вредоносный код, например:

`</textarea><script>alert(123)</script>

* При просмотре такого письма в интерфейсе как m., так и light., очевидно, ничего не происходит. Однако, код будет выполнен при попытке ответить на это письмо одним из следующих способов:

Жертва должна воспользоваться либо функцией "ответить всем" на это сообщение в интерфейсе light., либо функцией "ответить" в интерфейсе m. Оба таких действия приведут к открытию страницы с полем ввода текста письма с уже введенной цитатой вредоносного письма. При этом, HTML-код в такой цитате никак не будет фильтроваться. Это приведет к выполнению указанного злоумышленником кода.